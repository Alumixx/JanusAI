The Astrophysical Journal, 943:144 (19pp), 2023 February 1
© 2023. The Author(s). Published by the American Astronomical Society.

https://doi.org/10.3847/1538-4357/acaa9a

Principal-component Interferometric Modeling (PRIMO), an Algorithm for EHT Data. I.

Reconstructing Images from Simulated EHT Observations

Lia Medeiros1,4

, Dimitrios Psaltis2

, Tod R. Lauer3

, and Feryal Özel2

1 School of Natural Sciences, Institute for Advanced Study, 1 Einstein Drive, Princeton, NJ 08540, USA

2 Steward Observatory and Department of Astronomy, University of Arizona, 933 N. Cherry Ave., Tucson, AZ 85721, USA

3 NSF’s National Optical Infrared Astronomy Research Laboratory, Tucson, AZ 85726, USA

Received 2022 August 1; revised 2022 December 7; accepted 2022 December 8; published 2023 February 3

Abstract

The sparse interferometric coverage of the Event Horizon Telescope (EHT) poses a signiﬁcant challenge for both
reconstruction and model ﬁtting of black hole images. PRIMO is a new principal components analysis-based
algorithm for image reconstruction that uses the results of high-ﬁdelity general relativistic, magnetohydrodynamic
simulations of low-luminosity accretion ﬂows as a training set. This allows the reconstruction of images that are
consistent with the interferometric data and that live in the space of images that is spanned by the simulations.
PRIMO follows Monte Carlo Markov Chains to ﬁt a linear combination of principal components derived from an
ensemble of simulated images to interferometric data. We show that PRIMO can efﬁciently and accurately
reconstruct synthetic EHT data sets for several simulated images, even when the simulation parameters are
signiﬁcantly different from those of the image ensemble that was used to generate the principal components. The
resulting reconstructions achieve resolution that is consistent with the performance of the array and do not
introduce signiﬁcant biases in image features such as the diameter of the ring of emission.
Uniﬁed Astronomy Thesaurus concepts: Very long baseline interferometry (1769); Black hole physics (159);
Astronomy image processing (2306); Interferometry (808); Principal component analysis (1944); Accretion (14)

1. Introduction

The Event Horizon Telescope (EHT) Collaboration recently
imaged the supermassive black hole in the nearby giant
elliptical galaxy M87 for the ﬁrst time using submillimeter very
long baseline interferometry (VLBI) observations
(Event
Horizon Telescope Collaboration et al. 2019a, 2019b, 2019c,
2019d, 2019e, 2019f). The ﬁrst polarized images of the black
hole in M87 were published a short time later and indicated a
strong and ordered magnetic ﬁeld in the vicinity of the black
hole (Event Horizon Telescope Collaboration et al. 2021a,
2021b).

Reconstructing images of the M87 supermassive black hole
was challenging. The 2017 observations included only ﬁve
telescope locations, resulting in markedly sparse interfero-
metric (uv-plane) coverage. This challenge was extensively
addressed in the EHT papers and particularly in Event Horizon
(2019d), which is mainly
Telescope Collaboration et al.
concerned with a detailed discussion of the image reconstruc-
tion techniques used. In brief, a variety of algorithms was
employed and all were extensively tested with simulations and
intercompared on the images recovered from the actual
observations. Of necessity, each algorithm incorporated a
variety of assumptions to address the incomplete uv-plane
coverage, which in turn imply associated uncertainties in the
images recovered. The aim of this diverse approach was to be
conservative with the reconstructions and ensure that the major
quantities of astrophysical interest that were recovered from the
images were robust.

4 NSF Astronomy and Astrophysics Postdoctoral Fellow.

Original content from this work may be used under the terms
of the Creative Commons Attribution 4.0 licence. Any further
distribution of this work must maintain attribution to the author(s) and the title
of the work, journal citation and DOI.

the general

We begin with a discussion of

image
reconstruction techniques used so far,
followed by the
motivation for the PRIMO methodology that we introduce here.
General-purpose imaging algorithms: These include the
traditional CLEAN algorithm (Högbom 1974), as well as new
maximum likelihood methods (see, e.g., Chael et al. 2016;
Akiyama et al 2017; Event Horizon Telescope Collaboration
et al. 2019d). The challenge for general-purpose image
reconstruction algorithms is to generate an image among an
inﬁnite set of formally allowable solutions that are compatible
with the data. In order to reduce the range of possible solutions,
regularizers and secondary constraints (such as image global
entropy, smoothness, local curvature, etc) are levied to recover
an image that matches expectations of realistic structure. These
methods are agnostic to theoretical predictions of
image
morphology and can therefore be used to determine basic
image features such as the presence of a ring or brightness
depression. However, introducing constraints on the plausi-
bility of the image components is unavoidable and can lead to
artifacts as shown, e.g.,
in Figure 10 of Event Horizon
Telescope Collaboration et al. (2019d). Moreover, even though
the regularizing conditions are reasonable for some astronom-
ical images, they may not be well motivated for black hole
images since simulations predict steep gradients in parts of the
image (Psaltis et al. 2015).

Geometric ﬁts: These are posterior sampling algorithms that
ﬁt semi-analytic or geometric crescent- and ring-like models
directly to interferometric data (Kamruddin & Dexter 2013;
Event Horizon Telescope Collaboration et al. 2019f). The
models invoke a much smaller number of free parameters
and therefore do not require additional regularizers the way
that the general-purpose imaging algorithms do, as described
above. However, in some cases these simple models may not
be able to reproduce the complex image morphology predicted
for black hole images. Indeed, simulations predict that the

1

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

turbulent ﬂows generate complex and stochastic structures as a
consequence of the presence of bright, magnetically dominated
ﬂux tubes that are lensed by the black hole (see, e.g., Chan
et al. 2015a; Event Horizon Telescope Collaboration et al.
2019e). Since the expected level of complexity is not included
in the geometric model ﬁts,
the posteriors of the model
parameters are affected by the most inﬂuential data points and
may be biased (Psaltis et al. 2022).

from prior characterization of

Comparisons to numerical simulations: These methods
compare simulated images from general relativistic magneto-
hydrodynamic (GRMHD) simulations to interferometric data,
allowing for a rotation and scaling of the image relative to the
data (see, e.g., Event Horizon Telescope Collaboration et al.
2019e). This comparison leads to constraints on physically
meaningful parameters about the accretion ﬂow. However, a
single EHT observation corresponds to a particular realization
of the turbulent structure of the accretion that may be consistent
with simulations only in a statistical sense. As a consequence,
these methods beneﬁt
the
statistics of the various image structures and of the corresp-
onding interferometric observables (Kim et al. 2016; Event
Horizon Telescope Collaboration et al. 2019f).
We present a novel principal-component

interferometric
modeling (PRIMO) algorithm that combines the desirable
characteristics of the methods listed above while attempting to
limitations. PRIMO uses a large library of
reduce their
GRMHD simulations as a “training set” for image reconstruc-
tion and model ﬁtting. Instead of employing images that are
smooth (as in the case of the maximum likelihood imaging
methods) or consist of a limited number of broadened point
sources (as in the case of CLEAN), it utilizes images that are
broadly consistent with the space of possibilities spanned by
the simulations. Because it involves a relatively small number
of parameters, i.e., the coefﬁcients of the principal components,
it does not
require imposing regularizers as is done in
maximum likelihood methods. Furthermore, it is not limited
to simple geometric shapes, such as crescents and rings, and
can accurately reconstruct the stochastic features expected in
black hole images. At the same time, it does not compare
speciﬁc realizations of the turbulent images with the data but
rather uses a principal-component decomposition to derive a
basis for the space of possible images that are consistent with
theoretical expectations. Finally,
the principal components
analysis (PCA) algorithm provides not only the best-ﬁt image
but rather a complete posterior over all image structures that are
consistent with the data.

In addition to PCA, several other decompositions have been
developed and applied to a multitude of problems. Using bases
(called dictionaries), derived from PCA or other decomposi-
tions,
to sparsely represent a training set falls under that
umbrella of dictionary learning (see, e.g., Shao et al. 2014 for a
review of dictionary learning applied to image denoising).
Within astronomy, dictionary learning is frequently used to
denoise images and spectra, or
image classiﬁcation.
Convolutional neural networks are also becoming ubiquitous
in astronomy and have recently been applied to the output of
the Clean algorithm to denoise the results of
image
reconstructions (Gheller & Vazza 2022). Our goal
is not
denoising in the image domain; PRIMO reconstructs images
directly from the Fourier-domain visibilities. PCA is well
suited for our application since it enables remarkably powerful
dimensionality reduction, allowing us to ﬁt only 20 PCA

for

Medeiros et al.

components to the visibilities. Nonnegative matrix factoriza-
tion, for example,
is also commonly used in astronomical
applications (see, e.g., Zhu 2016). However, requiring that the
basis functions be positive deﬁnite can result in biases if the
basis is truncated, especially near steep gradients like those
expected near the boundary of the black hole shadow.

The PCA approach is very general but employs its own
restrictions on the subset of allowable images by only requiring
that the solution is likely to fall within the span of image
morphologies produced by the training set of simulations.
However, as is well known (see, e.g., Turk & Pentland 1991)
and we will also demonstrate later, the PCA-based algorithm
can reconstruct images even if the particular image structures
are different in their details from the individual simulation
snapshots that were used for the training set. Therefore, the
method can be applied to reconstruct a black hole image even if
the GRMHD outputs do not precisely represent all of its
characteristics.

In Medeiros et al. (2018b), we showed that PCA could be
used to efﬁciently represent the “space” of image morphologies
seen in GRMHD simulations of an accreting black hole. The
full range of structures seen in a simulation can then be
encoded as a linear combination of a compact set of orthogonal
“eigenimages,” with each eigenimage describing a portion of
the structure seen in the simulation. Critically, PCA minimizes
the number of components needed to describe the full variance
of the simulation and the components can be ordered by the
decreasing fraction of the variance that they describe.

A particular beneﬁt of

the PCA approach is that

the
orthogonal compact basis derived in image space transforms
identically to the same basis that would be derived directly by
representing the simulations in visibility (Fourier) space (see
Medeiros et al. 2018b for a mathematical proof). In short, the
basis can be built in the image domain, where we have the best
a priori knowledge of the likely image morphology, but is ﬁtted
in the complementary visibility space in which the observations
are presented.

Another beneﬁt of PRIMO is that

it not only provides
excellent recovery of structure up to the formal resolution limit
of the observations, but can provide “super-resolution” at yet
ﬁner scales. Rich knowledge of the intrinsic source structure
allows for quantitative measures of features that could not be
recovered without strong priors. The principal-component basis
encodes the intrinsic correlations of the source structure over a
range of angular
Interferometric observations of
structure within the resolution limit can implicitly constrain
the structure at ﬁner angular scales somewhat beyond it.

scales.

to ﬁnding the relative weights of

Given a set of interferometric data and a compact set of
eigenimages, the problem of image reconstruction and model
ﬁtting reduces
the
eigenimages that are necessary for
their weighted linear
combination to be consistent with the data. It is important to
emphasize, however, that while the image space of simulated
images is completely sampled by the PCA basis, the EHT
coverage provides only sparse, incomplete sampling of the
visibility space. As such, the basis functions in that space
(i.e., the visibility maps of the eigenimages) are no longer
orthogonal when sampled only at the discrete EHT baselines.
As a result, their coefﬁcients must be ﬁtted to the data with a
procedure that respects the resultant covariances that now
appear when the PCA components are ﬁtted to the visibilities.

2

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

The goal of this paper is to progress from the initial
presentation of the PCA image reconstruction methodology
introduced by Medeiros et al. (2018b) to a complete description
of how to apply it
to analyzing the EHT observations of
accreting supermassive black holes. In Section 2, we describe
the GRMHD simulations that we used to construct the PCA
basis, the preprocessing of the simulated images, and ﬁnally the
PCA basis that we derived from them. In Section 3, we
describe the Markov Chain Monte Carlo (MCMC) algorithm
we use to ﬁt interferometric data in order to obtain posteriors
over the relative weights of the PCA components. We present
results of applying PRIMO to simulated interferometric data in
Section 4 and summarize our work in Section 5.

2. Building a PCA Basis from GRMHD simulations
As outlined in Medeiros et al. (2018b), we perform PCA on
images generated from GRMHD simulations to describe the
image space in which EHT images of real accreting black holes
are likely to reside. In this section, we detail the methodology
used to derive the linear combination of PCA components
needed to ﬁt a given data set.

2.1. The GRMHD Simulations

The GRMHD simulation images employed to generate the
PCA basis were created using the massively parallel GPU-
based code GRay (Chan et al. 2013). As input to the radiative
transfer and ray-tracing simulations, we use two high-
resolution GRMHD simulations with long time spans that
were created using the 3D HARM code (Gammie et al. 2003;
Narayan et al. 2012; Sadowski et al. 2013).

The conﬁguration of a GRMHD simulation is speciﬁed by a
set of physical parameters. For the purposes of validating our
algorithm, we generated a set of 30 simulation runs, with
parameters covering a wide range of possible emission models
of the inner accretion ﬂow around the black hole in M87, as
follows.

1. GRMHD simulations only evolve the energy density
of the plasma and therefore primarily the temperature
of the ions and not of the electrons. In the accretion
ﬂow, the ion-to-electron temperature ratio is expected to
be determined primarily by the plasma β ≡ Pgas/Pmag
parameter, which is the ratio of the local gas to magnetic
pressures (Chan et al. 2015b). In the polar funnel, which
is magnetically dominated,
the two temperatures are
expected to be nearly equal due to magnetic conduction
(Ressler et al. 2015). In order to capture this behavior, we
used a prescription for the electrons that sets the ion-to-
electron temperature ratio Ti/Te to (Mościbrodzka et al.
2016; Event Horizon Telescope Collaboration et al.
2019d)

T
i
T
e

=

R

high

b
+

2
b

2

1

+

1
+

.

2

b

1

( )
1

We explore three values Rhigh = 1, 20, and 80, but note
that the simulations with Rhigh = 1 effectively result in an
electron temperature that is equal to the ion temperature
throughout the plasma, which is inconsistent with the
assumption of a radiatively inefﬁcient ﬂow. We choose to
include the simulations with Rhigh = 1 in our library only
for consistency with previous EHT publications and in

3

Medeiros et al.

order to explore a broad, albeit somewhat unphysical,
range of image structures.

2. The electron density scale provides an overall normal-
ization that sets the total accretion rate in the simulation.
We explored values for the electron density scale of
ne = 105, 2.5 × 105, 5 × 105, 7.5 × 105, and 106 cm−3.
We note that the higher values of electron number density
are unlikely for M87, given the measured 1.3 mm ﬂux
and polarization signatures (Event Horizon Telescope
Collaboration et al. 2019e, 2021b), but we include them
in our simulation data set for completeness.

3. In half of the simulations, we used initial conditions that
resulted in strong, ordered magnetic ﬁelds and a
magnetically arrested disk (MAD, see, e.g., Narayan
et al. 2012); in the other half, we used initial conditions
that resulted in a less ordered, weaker, magnetic ﬁeld,
commonly referred to as standard and normal evolution
(SANE, see, e.g., Igumenshchev et al. 2003).

4. We set the inclination angle of the black hole spin axis
relative to the observer’s line of sight to i = 17°. This
parameter only enters the radiative transfer calculation
and determines the relative asymmetry of the image (see,
e.g., Medeiros et al. 2022). We made this choice under
the assumption that the spin axis of the black hole is
parallel to the large-scale jet that has been observed at
radio wavelengths (Walker et al. 2018). In the PCA
model described below, we will allow for the possibility
that the spin axis is either aligned or antialigned with the
large-scale jet as well as for an arbitrary position angle of
the spin axis in the plane of the sky. Even though the last
two considerations affect the orientation of the black hole
image in the sky, they are trivial geometric transforma-
tions and do not enter the GRMHD simulations.

5. We set the black hole mass to M = 6.5 × 109 Me for the
initial preparation of the simulations, which is a value
consistent with the one obtained by stellar dynamics
(Gebhardt et al. 2011) and by the ﬁrst EHT imaging
results (Event Horizon Telescope Collaboration et al.
2019f). Changing this value has two effects on the
resulting simulations. First, it rescales the linear size of
each image by a factor proportional to the mass. Second,
it affects the outcome of the radiative transfer calculations
by altering the synchrotron emission/absorption coefﬁ-
cients and by rescaling the photon path lengths. For the
former effect, which is a trivial geometric transformation,
we explore different mass values by rescaling the angular
size of the PCA basis. For the latter effect, we note that,
in the relevant range of parameters, the black hole mass is
nearly degenerate with the electron number density scale
ne, with the image brightness at each pixel scaling as
(see Appendix A of Satapathy et al. 2022; see also
~n Me
Chan et al. 2015b). By exploring a broad range of values
for the electron density scale and allowing for a rescaling
of the images, we effectively probe a broad range of black
hole masses.

2

6. We assumed a single black hole spin parameter of
a = 0.9 for simplicity since image morphology is only
weakly dependent on spin (Event Horizon Telescope
Collaboration et al. 2019e). Indeed, as we show in later
sections,
the same PCA basis can also be used to
reconstruct images of black holes with other spins.

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 1. Effect of changing the electron density scale ne (different columns) and the ion-to-electron temperature ratio Rhigh (different rows) on a single snapshot from
a GRMHD simulation. This snapshot is from a MAD simulation with a black hole spin of a = 0.9 pointing upwards in each panel, with an observer inclination of
i = 17° and a black hole mass of M = 6.5 × 109Me. The brightness in each panel is normalized such that panels with the same value of ne have the same total ﬂux.
Increasing the electron density scale leads to images with large ring widths whereas changing the temperature ratio alters the relative brightness of the accretion ﬂow
and funnel regions.

Figure 1 shows the effect of changing the electron number
density scale, ne, and the ion-to-electron temperature ratio Rhigh
on a single snapshot from a MAD simulation. The electron
number density scale affects primarily the width of the bright
ring, with the latter increasing signiﬁcantly with increasing
ne (Satapathy et al. 2022). In contrast, the temperature ratio
Rhigh affects the relative brightness of different parts of the
ﬂow, altering the relative brightness between the funnel region
and the accretion ﬂow.

The set of parameters we discussed reﬂects a decision as to
which sources of image variance to include in the PCA analysis
and which parameters to treat externally. The position angle (f)
of the image on the sky, for example, can be included in our
model trivially by an overall rotation of the PCA components
and need not be included in the derivation of the components
themselves. Whether the spin axis is pointing toward us at 17°
or away from us at the complementary angle can also be
incorporated in a similar manner, as it describes (statistically) a
simple reﬂection. The effect of the black hole mass on image
morphology is mostly degenerate with the electron density
except for a change in the overall size of the image, which can
be included trivially in the PCA model as a scaling of angular
distances applied to all components. The overall source
position is also not included in the PCA basis since the current
set of EHT data only involve visibility amplitudes and closure
phases, which are independent of the image location.

For each set of parameters, we generated 1024 image
snapshots with a time resolution of 10 GM/c3. For the mass of
M87, the time resolution equals ∼3 days and 17 hours and each

simulation covers a total time span of over ten years. Each
snapshot has a ﬁeld of view of 64 GM/c2 and a resolution of
resolution).
1/8 GM/c2 per pixel
Critically, the ﬁeld of view is substantially larger than the
measured size of the image, which is ∼10 GM/c2, and the
resolution scale is sufﬁciently ﬁne to avoid deleterious aliasing
effects (Psaltis et al. 2020).

(approximately 0.5 μas

The set of 30 simulations provides a total of 30,720 images
covering a broad range of image morphologies. Figure 2
shows several snapshots from a single simulation. Here we
emphasize that although the parameters of the radiative
transfer simulations can signiﬁcantly affect gross image
properties, such as the width of the ring of emission (see
Figure 1), there is signiﬁcant variance in image morphology
even within a single simulation because of the stochastic
nature of the MHD turbulence in the accretion ﬂow (see also
Medeiros et al. 2017, 2018a, 2018b).

2.2. Preparing the Simulated Images for PCA

The simulated images have signiﬁcant structure at small
scales, which the EHT cannot probe. Because we want the PCA
basis to only reﬂect image variance on the physical scales
observed by the EHT, we ﬁrst need to eliminate the high-
spatial-frequency structure in each simulated image.

To achieve this, we use a Butterworth ﬁlter (Butterworth
1930), which is effectively a low-pass ﬁlter, having a ﬂat
response for low Fourier frequencies and declining to zero
smoothly at high frequencies. The Butterworth ﬁlter is deﬁned

4

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 2. Top row: ﬁve representative snapshots from the MAD simulation with ne = 5 × 105, Rhigh = 20, i = 17°, and M = 6.5 × 109 Me. Even within a single
simulation, there is signiﬁcant structural variability between the various snapshots. Bottom row: the same snapshots as the top row but ﬁltered using a Butterworth
ﬁlter with n = 2 and r = 15 Gλ, to mimic the ﬁnite resolution of the EHT. The brightness in each panel has been normalized such that all panels have the same
total ﬂux.

as

F
BW

( )
b

=

-

1 2

2

n

⎡
⎣⎢
1

+

⎛
⎝

b
r

⎞
⎠

⎤
⎦⎥

,

( )
2

where r is the scale of the ﬁlter and n is a power-law index. We
discuss in detail the motivation for using a Butterworth ﬁlter as
well as the choice of parameters for EHT data analysis in
Psaltis et al. (2020). The bottom row of Figure 2 shows the
snapshots of the top row ﬁltered by a Butterworth ﬁlter with
n = 2 and r = 15 Gλ. This choice of ﬁlter parameters allows us
to retain most of the power at baseline lengths probed by the
EHT array, while ﬁltering out most of the power at greater
lengths.

As a second step, we normalize each ﬁltered image to have
the same total ﬂux. Because images with higher electron
density scale ne have signiﬁcantly higher
total ﬂux, not
normalizing would have biased the PCA basis toward images
with higher ne values. We explored the effects of standardizing
the images by their variance and found that this has a negligible
effect on the PCA basis other than on the overall normal-
izations. We therefore do not standardize the images by their
variance. We also do not mean-subtract the images before
performing PCA, i.e., similar to what was done in Medeiros
et al. (2018b), since the properties of the mean image are
critical in ﬁtting the observed data. If, instead, we had mean-
subtracted the images before performing PCA, we would have
needed to add back the mean image to the linear combination
of PCA components, resulting in the same number of free
parameters in the model.

Since all of the images correspond to the same black hole
spin a = 0.9 and the same inclination angle i = 17°, all of the
black hole shadows are concentric and aligned with each other.
For the case of M87, this is justiﬁed because of the known
inclination of the large-scale jet as well as the weak dependence
of the simulated images on black hole spin. If that were not the
case, we would have also needed to recenter and align the

images before performing PCA, along the line of the approach
in Medeiros et al. (2020).

2.3. Building the PCA Basis

Given the complete set of ﬁltered simulated images, we
generated the PCA basis following the procedures established
in Medeiros et al. (2018b). Figure 3 shows the ﬁrst 20 PCA
components. The ﬁrst PCA component is similar to the average
image and contains a positive ﬂux. The higher-order PCA
components contain both positive and negative ﬂuxes, since
these components redistribute the ﬂux present
in the ﬁrst
component to approximate each individual snapshot.

The normalized eigenvalues corresponding to each PCA
component are shown in the top left corner of each panel. Each
eigenvalue measures the variance in pixel brightness of each
PCA component, normalized such that
the sum of all
eigenvalues is equal to unity. Figure 4 shows the eigenvalue
spectrum for this PCA decomposition. The ﬁrst few PCA
components account for the majority of brightness variance in
the image and only 20 components are needed to account for
99% of the variance found in the full set of simulations. The
slope of the eigenvalue spectrum for higher components is set
by the power spectrum of
the structures in the images
(Medeiros et al. 2018b).

Figures 5 and 6 show the corresponding visibility amplitude
and phase maps of the ﬁrst 20 PCA components. It is a linear
combination of these components in visibility space that we
will ﬁt directly to the data. As expected,
few
components contain primarily structures with low spatial
frequencies (i.e., small baseline lengths) and describe primarily
the broad-brush structure of
the image. The remaining
components contain signiﬁcant power at high spatial frequen-
cies (i.e.,
large baseline lengths) and describe the smaller
structures in the image.

the ﬁrst

It is interesting that, although this was not explicitly imposed
when performing the principal-component decomposition,
components of increasing PCA order correspond to higher-
order (m-fold) azimuthal symmetry. This is important when

5

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 3. The ﬁrst 20 PCA components for the set of simulated images employed in this paper. The respective proportions of variance explained are shown at the top
left corner of each panel. Red closed curves show the analytically calculated size and shape of the black hole shadow boundary, deﬁned as the critical impact
parameter between photons that fall into the black hole and those that escape, as seen by an observer at inﬁnity. The ﬁrst PCA component is similar to the average
image of the simulations, while contributions from the second component lead to thicker and thinner rings. The third and fourth components allow for either up–down
or left–right asymmetries. The higher-order components describe smaller-scale structure indicative of the variance seen in the simulated snapshots. Each panel is
normalized such that the full range of values falls within the range of the color bar.

for

the EHT baselines

comparing the angular structure of the PCA components to the
locations of
the 2017 M87
observations (Event Horizon Telescope Collaboration et al.
2019c), as also shown in Figures 5 and 6. Note that we have
rotated the baseline tracks such that the black hole spin axis,
which points upwards in all these panels, is at 288° east of
north. Clearly, the ﬁrst 20 PCA components already incorpo-
rate a substantial degree of azimuthal structure, which is ﬁner
than the angular separation of the dominant
locations in
visibility space probed by the EHT array. Lastly, note that each
component comprises detail over a broad range of spatial
frequencies. Within a given component, structural information
on ﬁne angular scales is correlated with that on broader scales.
This allows visibilities within the EHT band limit to lead to
inferences on the structure somewhat beyond it, producing
reconstructions with a degree of “super-resolution.”

3. MCMC Algorithm

In order to ﬁt EHT data, we implement the linear PCA model
(PRIMO)
into the MCMC algorithm Markov Chains for
Horizons (MARCH, Psaltis et al. 2022). For the purposes of
this initial exploration, we ﬁt this model to synthetic EHT data

calculated for the baseline tracks of the array during the 2017
April 5 observations of M87.

3.1. The PCA Image Model

The PCA decomposition described in Section 2 allows us to
construct a model for a black hole image that
is a linear
combination of N PCA components, with an appropriate
rescaling, to account for a different black hole mass, and an
appropriate rotation,
to allow for different orientations in
the sky.

We will be ﬁtting data in the visibility domain and therefore
the ﬁrst N PCA

we deﬁne the linear combination of
components in that domain as

˜(
I u v

,

)

N

å=
=

n

1

˜ (
u
n n

a

,
u v

)

,

( )
3

where ˜un are the PCA components in the Fourier (u, v) domain,
˜I is the Fourier-domain visibility of the reconstructed image,
and an is the amplitude of the nth PCA component. Without
loss of generality and in order to facilitate comparison with
other astrophysical measurements of the sources, we set a1 = 1

6

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Figure 4. The spectrum of normalized eigenvalues for the ﬁrst 5000 PCA
components derived from a set of 30,720 GRMHD snapshots. Only 10 PCA
components are necessary to reconstruct 98% of the total variance, whereas 20
can recover 99% of it.

and instead ﬁt for the total zero-baseline visibility amplitude,
which is also equal to the image ﬂux

( )
4

( )
5

F

N

å=
=

n

1

˜ (
u
n n

)
0, 0 .

a

By construction, this same linear combination of the PCA
components in the image domain also generates the “best-ﬁt”
image, i.e.,

(
I X Y

,

)

a

u
n n

(

X Y

,

)

,

N

å=
=

n

1

where now I is the reconstructed image and un are the PCA
components, both in the image domain (X, Y).

In addition to the N − 1 PCA amplitudes and the ﬂux
normalization F, the model also includes three parameters that
are implemented as a scaling, a rotation, and an up–down ﬂip
of the image. In particular, we introduce

1. A scaling parameter θg = GM/(Dc2) that is applied to all
PCA components in the sky domain (or equivalently q-
1
g
that is applied in the visibility domain). This scaling
parameter quantiﬁes the mass-to-distance ratio of the
particular black hole we are modeling and allows us to
convert the length scales in our images, which are in
gravitational units,
to angular sizes in the sky. This
parameter can also be informed by the strong priors
obtained by modeling the dynamics of stars around the
black hole (Event Horizon Telescope Collaboration et al.
2019f).

2. A position angle f, measured in degrees east of north,
applied to all PCA components,
that quantiﬁes the
orientation of the black hole spin on the plane of the sky.
the
possibility that the spin axis is pointing away from the
observer and therefore that the accretion ﬂow is rotating
in a sense that
is opposite to that of the simulation

j = −1, 1 that accounts

3. A ﬂip parameter

for

7

Medeiros et al.
(i.e., clockwise). In other words, if j = −1, we mirror all
PCA components along the x-axis such that the rotation
patterns will be oriented in the clockwise direction.

We note that, for computational efﬁciency, we do not use the
three parameters θg, f, and j to scale, rotate, and ﬂip each of the
PCA components. Instead, we use them to scale, rotate, and ﬂip
appropriately the small number of discrete u–v locations of the
EHT baselines. We then calculate the linear sum of the PCA
components at these locations using the interpolation technique
we discuss below.

In total, the PCA model has N + 3 free parameters, where N
is the number of PCA components used. Finally, it is worth
emphasizing that, even though the PCA model is linear in most
of its parameters, the visibility amplitudes and closure phases
that we ﬁt it to involve nonlinear operations.

3.2. Two-dimensional Interpolation

to the data. Since the PCA image model

At each step of the MCMC chain, the algorithm calculates
the model prediction at the (u, v) location of each data point and
compares it
is
numerical and sampled on a regular array of pixels, we evaluate
its prediction at any desired location using a 2D sinc
interpolation, which has been demonstrated to cause no
degradation of resolution of the 2D maps (Bracewell 1986).
In 1D, a sinc function is deﬁned as
(
p
sin
u
p
u

( )
=u

sinc

( )
6

)

,

where u is the pixel coordinate in the Fourier domain.
Interpolation in 2D is done with separable sinc kernels in u
and v that are multiplied to form a 2D kernel.

Along each orientation, the value of the visibility at

¢u is

given by

(
f u

)
¢ =

(
[
å p
sin
(
p
n

n

- D
n
u
)
- D
u

)]

( )
f n

,

u

u

where f (n) is the image value at the integer n locations, and
D = ¢ -
u. In practice, we limit the kernel to a ﬁnite domain
of ±u0, and taper it smoothly with a Gaussian to produce a
well-behaved cutoff in the Fourier domain,

(
f u

)
¢ =

1
C

u

u

0

D
å

sinc

n

=- D

u

u

0

(
n

- -D
e

)

u

2

2

2

s

[
sin
p

(
p
(
n

- D
n
u
)
- D
u

)]

( )
f n

,

( )
7

( )
8

where σ is chosen such that 2–3 cycles of the sinc function are
included. The normalization constant Csinc ensures that the
interpolation kernel has an integral of unity, given the tapering
and ﬁnite domain:

C

sinc

=

u

u

0

D
å

n

=- D

u

u

0

(
n

- -D
e

)

u

2

2

2

s

[
sin
p

(
p
(
n

- D
n
u
)
- D
u

)]

.

( )
9

[
(
p - Dn
u

)]

sin

However, since the
term is periodic with an
amplitude speciﬁed by the Δu phase, its particular value, but
for an alternating sign, is constant and thus is absorbed in the
normalization. In practice, evaluating a trigonometric function

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 5. The visibility amplitude maps of the ﬁrst 20 PCA components shown in Figure 3, normalized such that the peak in each component is equal to unity. The
peak values in visibility amplitude for many of the components are offset from the center, indicating that there is signiﬁcant negative ﬂux in the images, as can be seen
in Figure 3. White curves show the baseline tracks during the 2017 April EHT observations for the black hole in M87. In all panels, the black hole spin points upwards
and the orientation of north is shown by the green line segment in the upper left panel.

is not required, since we can write

(
f u

¢

)

=

1
¢
C
sinc

u

u

0

/

D
å

n

=- D

u

/

u

0

(
n

- -D
e

u

2

2

/

s

(
)
2
- D
u

n

-

1

)

n

( )
f u

where

C

¢
sinc

u

0

/

u

D
å=

n

=- D

u

/

u

0

(
n

- -D
e

u

2

2

/

s

(
)
2
- D
u

n

-

1

)

n

.

(

10

)

(

11

)

3.3. The Posterior Distribution

Having deﬁned a visibility-domain PCA model that depends
on N + 3 model parameters, which we collectively denote by

q, we use Bayes’ theorem to write the posterior over
the vector
these parameters as


( ∣
q

P

data

)

=

C P

pri


( )
q



(

data


∣ )
q

.

(

12

)


( )
qPpri
is the prior distribution over the model parameters,
Here,

∣ )
(
 data
q
is the likelihood that the set of observations can be
obtained from the model, and C is an appropriately deﬁned
normalization constant.

The set of data obtained by the EHT is a series of visibi-
lity amplitudes at the various baseline lengths between the
different pairs of stations as well as a series of closure phases
along all possible baseline triangles (Event Horizon Telescope
Collaboration et al. 2019c). We calculate the likelihood
function by multiplying the likelihoods of
the individual
visibility amplitude and closure phase data (see, however,
Blackburn et al. 2019), assuming that all
likelihoods are
independent of each other:



(

data


∣ )
q

=

(



i

data


∣ )
q

.

i

(

13

)

The precise deﬁnition of the various likelihoods is provided in
detail in Psaltis et al. (2022). Because they depend only on the
data products, they are the same for all models. The priors over
the model parameters, however, are speciﬁc to each model, as
we discuss in detail in the following subsection.

3.4. Priors

To ensure that our PCA model is probing physically relevant
areas of the parameter space, we include a combination of

8

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 6. Same as Figure 5 but for visibility phase maps.

informative and uninformative priors on the various model
parameters.

the zero-baseline ﬂux of

Because the EHT is an interferometer, the total ﬂux F of the
compact image cannot be directly measured without perfect
knowledge of the prior calibration of the various telescope
gains. However,
it can often be independently constrained
using other single-dish observations. Due to extended emis-
sion,
the M87 EHT data was
signiﬁcantly higher than what was reasonably expected for
the compact source (see the discussion in Appendix B of Event
Horizon Telescope Collaboration et al. 2019d). Because of this,
most M87 EHT analyses constrained the zero-baseline ﬂux to a
well-motivated value. To mirror those analyses, we ﬁx the
zero-baseline ﬂux at 0.6 Jy, the value used to generate the
synthetic data.

For

the scaling parameter θg,

there often exist prior
measurements based on gas and/or stellar dynamics. For the
M87 black hole, the two measurements are not statistically
consistent with each other (see Gebhardt et al. 2011; Walsh
et al. 2013). The envelope of the credible intervals for these
two measurements is contained within the conservative range
1 μas  θg  6 μas. For
reason, we simply use an
uninformative prior
⎧
⎨⎩

if 1 as
otherwise.

 

6 as

this

q
0

14

q
g

q
g

=

-
g

m

m

P

(

(

)

1

)

For

the orientation parameter f, we employ a highly
informative prior based on the assumption that the black hole

spin is either aligned or antialigned with the large-scale jet
observed at longer wavelengths, i.e., that

( )
f

P

=

1
ps

2
f

2 2

[

(
f f

- -
e

0

2

)

2

s

2
f

+

(
f f

- - +
e

0

)

p

2

2

s

2
f

]

.

(

15

)

Here f0 = 288° is the orientation of the large-scale jet (Walker
et al. 2018). We set the widths of the two Gaussians to a
nominal value of σf = π/8. We allow the ﬂip parameter j to be
equal to either 1 or –1, with the same prior.

Finally, we employ informative priors on the amplitudes of
the PCA components. Our aim is to give higher priors to
images for which the amplitudes of the PCA components are
not very dissimilar from the amplitudes that correspond to the
simulated images used to calculate the PCA decomposition.
However, we also do not wish to limit the ﬁt to images that
have precisely the same range of amplitudes as the training set.
To achieve this, we ﬁrst calculate the distribution of amplitudes
for each PCA component found in the ensemble of training
images and then broaden this distribution by a factor of two.
Figure 7 shows the distribution of normalized amplitudes,
an/a1, for the PCA components 2 through 21 that we calculated
above; note that, by deﬁnition, we have set a1 = 1. Each panel
also shows a Gaussian (in orange) with the same mean and
standard deviation as
the numerical distribution. These
Gaussians provide good descriptions of the distributions for
almost all of
the components shown in the ﬁgure, with
components 2 and 5 being notable exceptions. Both of these
components contain structure that controls the width of the ring

9

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 7. The distribution of the normalized amplitudes, an/a1, for PCA components 2 through 21. The red dotted lines show the mean of the distribution in each
panel and the dashed orange lines show Gaussians with widths set by the standard deviations of the distributions and with peaks at the means of the distributions. The
green dashed curves show the Gaussians broadened by a factor of two. We use the broadened Gaussians as priors to allow for reconstruction of images that are outliers
within the distributions as well as of images that are similar to but are not contained in our training set.

Figure 8. Fractional complex error (òcomplex, left), fractional error in visibility amplitude (òVA, middle), and error in visibility phase (òVP, right) for reconstructions with
5, 10, 15, 20, 25, 30, and 35 PCA components. The black curve shows the error between the original unﬁltered snapshot and the snapshot ﬁltered with the Butterworth
ﬁlter with r = 15 Gλ and n = 2. All reconstructions are compared to the original unﬁltered snapshot. We calculate these error quantities for each of the 30,720
snapshots, and then average them as a function of baseline length. The longest baseline that the 2017 EHT array could observe was ∼8 Gλ. Reconstructions with 20
components achieve errors less than ∼3% for òcomplex, ∼2% for òVA, and ∼15° for òVP for baseline lengths observable by the 2017 EHT array.

in the image, which is strongly dependent on the simulation
parameters (e.g., ne). Therefore, the distributions of amplitudes
for these components are not expected to follow a Gaussian
distribution but rather will depend on the particular set of
parameters used for the simulation library.

Gaussian distributions with the same mean but twice the
standard deviation are also shown in each panel (green dashed
lines) and comfortably include the full range of amplitudes

found in the training image set. In practice, for computational
efﬁciency, we use these broadened Gaussians as priors on the
amplitudes of each PCA component. In other words, we write
the prior
the nth PCA
component an/a1 as

the normalized amplitude of

for

(
P a

n

)
a
1

-
an a
an a
1
1
s
2
n

(

p s
2 2
n

)

,

(

16

)

(

1
2

⎡
= -
⎣⎢
e

2

)

⎤
⎦⎥

10

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 9. Top left: simulated image used for the generation of the ﬁrst synthetic data set. Top right: the highest likelihood PRIMO reconstruction for the synthetic data.
PRIMO can accurately reproduce the depth and shape of the brightness depression, the size and width of the ring of emission, and the brightness asymmetry of the
ring. Bottom left: the original image blurred by a Gaussian ﬁlter with a width of 15 μas, which mimics the nominal resolution of the EHT (see text). Bottom right: the
simulated image convolved with a Butterworth ﬁlter with radius r = 15 Gλ and index n = 2. The brightness in all panels has been normalized such that all images
have the same total ﬂux, with the exception of the Gaussian-broadened image, which has a total ﬂux that is 1.5 times higher than the other panels. In all panels, the
gray dotted circles indicate the analytically calculated size and shape of the black hole shadow. The original and ﬁltered images have been rotated to the position angle
used to generate the synthetic data set and the PRIMO reconstruction has been rotated by the position angle f derived from the model.

an

1 and σn are the mean value and standard deviation
where a
of the distribution of normalized amplitudes of the training set.

3.5. Theoretical Uncertainty

In most applications of PCA, one can reconstruct an image
by simply projecting the image onto the PCA components to
ﬁnd the relative amplitude of each component that will result in
the best possible reconstruction. Using a higher number of
components will invariably result in a higher-ﬁdelity recon-
struction. A lossless reconstruction can always be achieved
using all of the PCA components, if the image is part of the
original set that was used to calculate the PCA decomposition.
In the present application, however, we do not have a full
image onto which we can project the components; we instead
have sparse u–v coverage. Attempting to ﬁt a large number of
components to sparse interferometric data can result
in

overﬁtting since there may be several possible linear combina-
tions of components that ﬁt the data. Therefore, there exists an
optimal number of PCA components for which the highest-
ﬁdelity reconstruction can be achieved by ﬁtting the sparse
interferometric data while respecting the resolution of the array.
In order to determine this optimal number and assess the
error introduced by the truncation, we quantify the error in the
visibility amplitudes between a reconstruction with N compo-
nents and the original, unﬁltered image in the Fourier domain
as


complex

=

∣(

V
0

-

V
N

V

-*
0

V

*
N

)∣

,

)(
F

(

17

)

where F is the total ﬂux of the image, VN are the complex
visibilities of the reconstruction, vertical bars indicate magni-
tude, and the asterisk denotes complex conjugation. We deﬁne

11

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 10. Left: synthetic visibility amplitude data and the amplitudes that correspond to the most likely PRIMO reconstruction. The theoretical uncertainty (see
Section 3.5) is shown as error bars on the model. The residuals of the ﬁt are shown below, with the theoretical and observational uncertainties having been added in
quadrature. Right: the same but for the synthetic closure phase data.

respectively. The error in visibility phase is deﬁned as

∣

(

=


VP

arg

V
orig
if this quantity is <180° and
(
arg

360

=

-


VP

∣



)

-

arg

(

V
recon

)∣

V
orig

)

-

arg

(

V
recon

)∣

otherwise. We calculate these errors for each baseline length by
averaging along different azimuthal orientations and over the
complete set of images in the training set.

In both equations above,

denotes the argument or
phase of the complex visibilities of the images. When taking
the average of the error in visibility phase, we follow Mardia &
Jupp (2009) and deﬁne the average of a directional quantity as

)Varg

(

¯
q

=

-
tan
-
tan

1

1

,

¯)
( ¯
S C
¯)
( ¯
S C

⎧
⎨⎩

+

p

,

¯
C
¯
C


<

if
if

0
0,

where

(

19

)

(

20

)

(

21

)

(

22

)

¯
S

=

¯
C

=

1
n
1
n

n

1

j

å
=
n
å
=

j

1

sin

q

j

cos

q

.
j

Figure 8 shows the errors òcomplex, òVA, and òVP as functions
of baseline length, for all 30,720 snapshots and for different
values of the number N of PCA components. The ﬁgure also
compares these errors to those introduced to the original images
by the application of the Butterworth ﬁlter. In all three error
quantities, there are signiﬁcant broad peaks at around 1–4 Gλ,
which are introduced by the dips, or nulls, that exist in the
training set around these baseline lengths (see Medeiros et al.
2017 for a discussion of the origin of these uncertainties).

The longest baselines included in the 2017 EHT array are
about 8 Gλ. Reconstructions with 20 components achieve
fractional complex errors less than ∼3% at all baselines less
than 8 Gλ, even at baseline lengths that frequently have a

12

Figure 11. Comparison of the horizontal (top) and vertical (bottom) cross
sections of the images shown in Figure 9. The curves show the original
snapshot (green), the snapshot ﬁltered with a Butterworth ﬁlter (blue), the most
likely PRIMO reconstruction (red), the snapshot ﬁltered with a 15 μas Gaussian
(cyan), and the analytically calculated edges of the black hole shadow (gray
dotted vertical lines). The cross sections are normalized such that all images
have the same total ﬂux, except for the Gaussian-broadened image, which has
1.5 times the ﬂux of the other images. The y-axis is in arbitrary units. PRIMO
can accurately reproduce the main features of the image and does not introduce
a signiﬁcant bias in the ring size.

the fractional error in visibility amplitude as


VA

=

∣
∣
V
orig

∣
∣
V
recon

,

-
F

(

18

)

where |Vorig| and |Vrecon| denote the amplitude of the complex
visibilities
images

reconstructed

original

and

the

for

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 12. Corner plot for the MCMC run that corresponds to Figures 9, 10, and 11. Here, for brevity, we only include the ﬂux parameter, the scaling parameter (θg),
the orientation parameter (f), and the amplitudes of the ﬁrst 10 PCA components. The red vertical and horizontal dashed lines denote the values with the highest
likelihood, while the vertical and horizontal green dashed lines denote the ground-truth values of these parameters. The dotted Gaussian curves and dotted vertical
lines in the diagonal plots for the PCA amplitudes indicate the Gaussian prior for each amplitude used in the MCMC chain.

signiﬁcant dip in visibility amplitude. The same reconstructions
achieve a fractional error in visibility amplitude of less than
∼2% and an error in visibility phase less than ∼15° at all
baselines less than 8 Gλ. At baselines that do not coincide with
the minima in visibility amplitude, the errors are signiﬁcantly
smaller; fractional complex error in visibility amplitude for
reconstructions with just 20 PCA components is ∼2% in
regions between minima in visibility amplitude.

Since the reconstructions with only 20 PCA components
achieve errors that are comparable to the errors in the EHT

2017 data for M87, in this work we settle on ﬁtting 20 PCA
components to synthetic data as a proof of concept. However, a
slightly higher or lower number of components may achieve
comparable or even better results. We use the results presented
in Figure 8 to add a “theoretical error” to our model, which is
implemented as an additional uncertainty, as a function of
baseline length. In order to account for the fact that the peaks in
the theoretical uncertainties shown in Figure 8 correspond to
the locations of the visibility minima, which themselves scale
inversely with θg, we scale the baseline lengths of
the

13

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 13. Same as Figure 9 but for the second synthetic data set we consider.

Figure 14. Same as Figure 10 but for the same synthetic data set as shown in Figure 13.

14

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

of this image, arriving at the correct ring size and width, and
the correct position angle for the peak of emission along
the ring.

The bottom row of the ﬁgure shows the original image
blurred by a Gaussian ﬁlter with a width of 15 μas and the
original image after it was ﬁltered with an n = 2, r = 15 Gλ
Butterworth ﬁlter. The Gaussian-broadened image approxi-
mates previously published EHT images, since most of the
EHT reconstructed images published to date have been
broadened by Gaussians. The width of the Gaussian kernel
was chosen such that the median FWHM of the image, along
128 equispaced radial cross sections emanating from the center
of the black hole shadow, is equal to 20 μas, i.e., similar to the
M87 images reconstructed with other algorithms. (We note that
we simply broadened the original simulated image and did not
simulate CLEAN or regularized maximum likelihood (RML)i-
maging of it; still, the Gaussian-broadened GRMHD image
provides a simpliﬁed comparison to the resolution of
previously published EHT images.) PRIMO achieves much
higher image ﬁdelity than the Gaussian-blurred image and
approaches the ﬁdelity of the GRMHD input image simply
blurred by the Butterworth ﬁlter.

Figure 10 compares the visibility amplitudes and the closure
phases of the synthetic data created from the simulated image
as described in Section 3.6 to those of the reconstructed image
with the highest
likelihood. The model shows very good
agreement with the synthetic data and no structure is present in
the residuals. As expected, because of the very large signal-to-
noise ratio of most of the EHT measurements, the residuals are
dominated by the theoretical errors introduced by the truncation
in the number of PCA components used. Nevertheless, this
truncation does not introduce any substantial biases in the
image structure or its properties.

Figure 11 compares the vertical (N–S) and horizontal (E–W)
cross sections of the original image, the Butterworth-ﬁltered
snapshot, the Gaussian-ﬁltered snapshot, and the most likely
reconstruction with PRIMO. There is remarkable agreement
between the properties of the reconstructed image and those of
the original one. In particular, the PRIMO ﬁt is a much more
accurate representation of
than the
snapshot convolved with a 20 μas beam. The main features
of the cross sections, i.e., the location and amplitude of the
peaks, the width of the peaks, the size and depth of the central
ﬂux depression, and the relative amplitude difference between
the two peaks, are well approximated by the reconstruction.

the original snapshot

Figure 12 shows a corner plot for numerous key parameters
for the MCMC run discussed above. The corner plot shows a
few correlations between parameters, such as between the
scaling parameter θg and the amplitude of the second PCA
component, as well as with several other components but to a
lesser extent. Although the PCA components are orthogonal
when considered across the entire image (or u–v space), they
are no longer orthogonal when we consider only the discrete
locations of
this, some
correlations between different PCA components are also
visible, such as between the second and fourth components.
The correlation between the overall scale (θg) and the second
component is not surprising: the second component affects the
width of the ring, which is highly correlated with the diameter
of the ring.

the EHT baselines. Because of

The widths of the posteriors of most of the low-order PCA
components are signiﬁcantly smaller than those of the priors,

Figure 15. Same as Figure 11 but for the second synthetic data set.

theoretical error curves in a similar way. Moreover, because the
errors shown in this ﬁgure are fractional, we multiply them by
the total ﬂux F in the image.

3.6. Preparing Simulated Data

The EHT observations are simulated as follows. For each
data point in the M87 EHT data, we use sinc interpolation to
interpolate between pixels in u–v space and approximate the
visibility at that u–v location. In order to mimic thermal noise,
we dither each data point with errors derived from a Gaussian
distribution with a standard deviation set by the error in the
EHT data at each u–v location for the 2017 EHT observations
of M87. We do not include gain errors in our synthetic data at
this time, nor do we include gains as free parameters in our
model.

4. Results from Synthetic Data

In order to demonstrate the performance of PRIMO with
EHT data, we apply it to a number of synthetic data sets created
from simulated snapshots. We start with two snapshots from a
single GRMHD+radiative transfer MAD simulation with
electron number density scale ne = 105 cm−3, electron temper-
ature parameter Rhigh = 20, black hole spin aBH = 0.9, and
mass M = 6.5 × 109 Me. This set of parameters is relevant to
the black hole in M87 and is consistent with the recent EHT
results that showed that
the polarization structure of M87
shows preference to MAD models over SANE models (Event
Horizon Telescope Collaboration et al. 2021a, 2021b). These
two snapshots were also considered in Psaltis et al. (2022) but
for different values of the Rhigh parameter.

We begin by applying our algorithm to a simulated image
snapshot
resembles a crescent shape but has some
extended structure. This snapshot was not easily ﬁt by a
simple geometric crescent model (Psaltis et al. 2022, see
Figures 16 and 17). The top row of Figure 9 shows the
simulated image and the highest likelihood reconstruction from
PRIMO after 10,000,000 MCMC steps. Unlike the geometric
crescent model, PRIMO can easily reproduce the morphology

that

15

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 16. Same as Figure 12 but for the MCMC run shown in Figures 13, 14, and 15.

demonstrating that the broad-brush properties of the recon-
structed image are driven by the data and not by the priors. This
is increasingly less the case for
the higher-order PCA
components, justifying the level at which we truncated the
series of components. The ﬁgure also compares the ground-
truth values (shown in green) to the values with the highest
likelihood from the reconstruction (shown in red).5 In all cases,
there is a remarkable agreement between the two.

5 For the amplitudes of the PCA components, we treat the amplitudes derived
by projecting the original image onto the ﬁrst N PCA components as the
ground-truth values.

As a second example, we apply PRIMO to synthetic data
generated from a second snapshot that is dominated by an
extended ﬂux tube. The geometric crescent ﬁt to this image
failed to reconstruct a reasonable ring size even when a
Gaussian component was added to the model (see Figures 18
and 19 in Psaltis et al. 2022). However, as can be seen in
Figures 13–16, PRIMO can accurately reconstruct the location
of the peak of emission along the ring, the width of the peak,
the shape and depth of the central ﬂux depression, and the
extended ﬂux tube toward the top left of the image. The
visibility amplitudes and closure phases from the reconstructed

16

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 17. Same as Figure 9 but for the third synthetic data set, which was not contained in the training set but was generated from a GRMHD simulation with a
SANE magnetic ﬁeld geometry and a black hole spin of aBH = 0.7. Despite not being part of the training set, salient features of the images are accurately reconstructed
by PRIMO.

image show good agreement with the synthetic data and very
little structure is visible in the residuals.

Finally, we consider an image that is not included in the
training ensemble used to generate the PCA components.
While all images in the training set have a black hole spin of
aBH = 0.9, for the ﬁnal synthetic data set we use an image from
a simulation with a black hole spin of aBH = 0.7. This image
has a SANE magnetic ﬁeld geometry and a plasma parameter
of Rhigh = 20. Figures 17, 18, and 19 show the results of
reconstructing this image with PRIMO. Even though this image
was not included in the ensemble used to generate the PCA
components,
still able to accurately
reconstruct the salient image features, such as the depth and
shape of the brightness depression, the size and width of the
peak, the orientation of the peak brightness asymmetry in the
ring feature, and the extended structure toward the top left of
the image.

the algorithm was

5. Summary

We have presented a novel PCA-based image reconstruction
algorithm, PRIMO, for reconstruction of black hole images

from EHT data. Our algorithm is unique in that it combines
prior information from physically motivated simulations to
reconstruct images that lie in the same general space of images
spanned by the simulations. Each simulation can create
countless images with different morphologies due to the
turbulent nature of the accretion ﬂow, making it unlikely that
the particular realization of the turbulent ﬂow of the source that
the EHT observes would be well ﬁt by any one of the
thousands of simulation images included in our
library.
However, the PCA-based algorithm allows us to reconstruct
images regardless of whether or not they are contained within
the library of images from which the PCA basis was created.
Compared to the results of previous work, PRIMO is not
severely affected by the biases identiﬁed in Psaltis et al. (2022),
where simulated images were ﬁt with analytic crescent models.
this work we have used the EHT baseline
coverage from the 2017 observations. Since then, the EHT has
observed several more times with additional telescopes. We
expect
that, with additional baselines, we will be able to
incorporate a higher number of PCA components to generate
images from the data and achieve even better angular

Throughout

17

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Figure 18. Same as Figure 9 but for the third synthetic data set we consider.

ORCID iDs

Lia Medeiros
Dimitrios Psaltis
Tod R. Lauer
Feryal Özel

https://orcid.org/0000-0003-2342-6728

https://orcid.org/0000-0003-1035-3240

https://orcid.org/0000-0003-3234-7247

https://orcid.org/0000-0003-4413-1523

References

Akiyama, K., Ikeda, S., Pleau, M., et al. 2017, AJ, 153, 159
Blackburn, L., Chan, C.-k., Crew, G. B., et al. 2019, ApJ, 882, 23
Bracewell, R. N. 1986, The Fourier Transform and Its Applications (New

York: McGraw‐Hill)

Butterworth, S. 1930, Wireless Engineer, 7, 536
Chael, A. A., Johnson, M. D., Narayan, R., et al. 2016, ApJ, 829, 11
Chan, C.-k., Psaltis, D., & Özel, F. 2013, ApJ, 777, 13
Chan, C.-k., Psaltis, D., Özel, F., et al. 2015a, ApJ, 812, 103
Chan, C.-K., Psaltis, D., Özel, F., Narayan, R., & Sadowski, A. 2015b, ApJ,

Event Horizon Telescope Collaboration, Akiyama, K., Alberdi, A., et al.

Event Horizon Telescope Collaboration, Akiyama, K., Alberdi, A., et al.

Event Horizon Telescope Collaboration, Akiyama, K., Alberdi, A., et al.

799, 1

2019a, ApJL, 875, L1

2019b, ApJL, 875, L2

2019c, ApJL, 875, L3

2019d, ApJL, 875, L4

2019e, ApJL, 875, L5

ApJL, 875, L6

2021a, ApJL, 910, L12

2021b, ApJL, 910, L13

Event Horizon Telescope Collaboration, Akiyama, K., Alberdi, A., et al.

Event Horizon Telescope Collaboration, Akiyama, K., Alberdi, A., et al. 2019f,

Event Horizon Telescope Collaboration, Akiyama, K., Algaba, J. C., et al.

Event Horizon Telescope Collaboration, Akiyama, K., Alberdi, A., et al.

Gammie, C. F., McKinney, J. C., & Tóth, G. 2003, ApJ, 589, 444
Gebhardt, K., Adams, J., Richstone, D., et al. 2011, ApJ, 729, 119
Gheller, C., & Vazza, F. 2022, MNRAS, 509, 990
Högbom, J. A. 1974, A&AS, 15, 417
Igumenshchev, I. V., Narayan, R., & Abramowicz, M. A. 2003, ApJ, 592, 1042
Kamruddin, A. B., & Dexter, J. 2013, MNRAS, 434, 765
Kim, J., Marrone, D. P., Chan, C.-K., et al. 2016, ApJ, 832, 156
Mardia, K. V., & Jupp, P. E. 2009, Directional Statistics, Vol. 494 (Chichester:

Medeiros, L., Chan, C.-K., Narayan, R., Özel, F., & Psaltis, D. 2022, ApJ,

Medeiros, L., Chan, C.-k., Özel, F., et al. 2017, ApJ, 844, 35

Wiley)

924, 46

18

resolution. The EHT is also planning to observe at 345 GHz in
the coming years, which will allow us to probe even higher
spatial frequencies. PRIMO can easily be adapted to exploit
these new observations.

We thank C. K. Chan, P. Hallur, and B. Zackay for useful
discussions. L. M. gratefully acknowledges support from an
NSF Astronomy and Astrophysics Postdoctoral Fellowship
under award no. AST-1903847. D.P. and F.O. gratefully
acknowledge support from NSF PIRE grant 1743747 for this
work. All ray-tracing calculations were performed with the
El Gato GPU cluster at the University of Arizona that is
funded by NSF award 1228509.

Figure 19. Same as Figure 11 but for the third synthetic data set we consider.

Event Horizon Telescope Collaboration, Akiyama, K., Alberdi, A., et al.

The Astrophysical Journal, 943:144 (19pp), 2023 February 1

Medeiros et al.

Medeiros, L., Chan, C.-k., Özel, F., et al. 2018a, ApJ, 856, 163
Medeiros, L., Lauer, T. R., Psaltis, D., & Özel, F. 2018b, ApJ, 864, 7
Medeiros, L., Psaltis, D., & Özel, F. 2020, ApJ, 896, 7
Mościbrodzka, M., Falcke, H., & Shiokawa, H. 2016, A&A, 586, A38
Narayan, R., Sadowski, A., Penna, R. F., & Kulkarni, A. K. 2012, MNRAS,

Psaltis, D., Medeiros, L., Lauer, T. R., Chan, C.-K., & Özel, F. 2020,

426, 3241

arXiv:2004.06210

Ressler, S. M., Tchekhovskoy, A., Quataert, E., Chandra, M., & Gammie, C. F.

2015, MNRAS, 454, 1848

Satapathy, K., Psaltis, D., Özel, F., et al. 2022, ApJ, 925, 13
Shao, L., Yan, R., Li, X., & Liu, Y. 2014, IEEE Trans. Cybernetics, 44, 1001
Sadowski, A., Narayan, R., Penna, R., & Zhu, Y. 2013, MNRAS, 436, 3856
Turk, M., & Pentland, A. 1991, J. Cognitive Neurosci., 3, 71
Walker, R. C., Hardee, P. E., Davies, F. B., Ly, C., & Junor, W. 2018, ApJ,

855, 128

Psaltis, D., Özel, F., Chan, C.-K., & Marrone, D. P. 2015, ApJ, 814, 115
Psaltis, D., Özel, F., Medeiros, L., et al. 2022, ApJ, 928, 55

Walsh, J. L., Barth, A. J., Ho, L. C., & Sarzi, M. 2013, ApJ, 770, 86
Zhu, G. 2016, arXiv:1612.06037

19

